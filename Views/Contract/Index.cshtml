@model IEnumerable<GP.Models.Contract>

@{
    ViewData["Title"] = "Index";
          //  Layout = "~/Views/Shared/_LayoutOwner.cshtml";

             if (User.IsInRole("Owner"))
    {
        Layout = "/Areas/Identity/Pages/Account/Manage/_Layout.cshtml";
      
    }

}


<div class="text-center pt-3 pb-5">
    <p class=" fw-bold borderbottom fs-3 d-inline-block">العقود</p>
</div>

<table class=" pt-5 table table-bordered table-md text-center ">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.SallerName)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Sallerphone_num)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Description)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.BuyerName)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Buyerphone_num)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Longitude)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Latitude)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.OnDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.up_to_date)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Type)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.category)
            </th>
           
            <th>
                الحالة
                
            </th>
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model) {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.SallerName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Sallerphone_num)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Description)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.BuyerName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Buyerphone_num)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Longitude)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Latitude)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.OnDate)
            </td>
            
             @if(item.Type == "إيجار"){
                   <td>
                    @Html.DisplayFor(modelItem => item.up_to_date)
                    </td>
                }

                else
                {
                    <td></td>
                }

            <td>
                @Html.DisplayFor(modelItem => item.Type)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.category)
            </td>
                @{

                   
                    if(item.Type == "إيجار" )
                    {

                        if (item.isDone == 1)
                        {
                            <td>
                                   <a href="#" class="btn btn-danger" >   تم تفعيل العقار</a>
                            </td>
                        }
                        else if(item.up_to_date < DateTime.Today)
                        {
                               <td>
                                  <a href="/Contract/EeEstate/@item.Id" onclick="confirm('done')" class="btn btn-success"  >تفعيل العقار</a>
                            </td>

                        }

                        else
                        {
                             <td>
                                   <a href="#" class="btn btn-danger" >   العقار محجوز  </a>
                            </td>
                        }

                        }

                        
                    }
                
        </tr>
}
    </tbody>
</table>



@section Scripts{


    
    <script>


        
        $(document).ready(function () {
            $('.js-delete').on('click',function(){
                var btn = $(this);



                bootbox.confirm({
                    message: "Are you sure that you need to delete this user ?",
                    buttons: {
                        confirm: {
                            label: 'Yes',
                            className: 'btn-danger'
                        },
                        cancel: {
                            label: 'No',
                            className: 'btn-success'
                        }
                    },
                    callback: function (result) {
                        //console.log('This was logged in the callback: ' + result);
                        if(result){
                            $.ajax({
                                url:'Contract/M/'+btn.data('id'),
                                
                               
                            })
                        }
                    }
                });


                





            });
        });
    </script>
}